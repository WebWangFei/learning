<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body></body>
</html>
<script>
  // è‡ªå®šä¹‰iteratoræ¥å£
  /**
   * iteratorè§„åˆ™
   * 1.è°ƒç”¨nextæ–¹æ³•ï¼Œæœ‰ä¸¤ä¸ªå‚æ•°ï¼Œvalue-å½“å‰çš„å€¼ï¼Œdone:æ˜¯å¦ç»“æŸæ ‡è¯†
   * 2.å…·æœ‰Symbol.iteratoræ–¹æ³•
   * 3.å¯ä»¥ç»ˆæ­¢return

   */
  class Counter {
    constructor(limit) {
      this.count = 1;
      this.limit = limit;
    }
    next() {
      if (this.count <= this.limit) {
        return { value: this.count++, done: false };
      } else {
        return { value: undefined, done: true };
      }
    }
    [Symbol.iterator]() {
      return this;
    }
  }
  let a = new Counter(3);
  for (let s of a) {
    console.log("--ğŸš€-- ~ s", s);
  }
  // Counterç±»é‡Œçš„countå˜é‡åœ¨å®ä¾‹åŒ–ä¸”è¿­ä»£ä¹‹åå·²ç»æ”¹å˜ï¼Œä¸èƒ½è¿›è¡Œå¤šæ¬¡è°ƒç”¨
  for (let s of a) {
    console.log("--ğŸš€-- ~ 22", s);
    // ç©ºå€¼
  }

  // 2.0ç‰ˆæœ¬

  class Counter1 {
    constructor(limit) {
      this.limit = limit;
    }
    [Symbol.iterator]() {
      // å˜é‡æ¯æ¬¡å®ä¾‹åŒ–ä¹‹åè¿›è¡Œåˆå§‹åŒ–
      let count = 1,
        limit = this.limit;
      return {
        next() {
          if (count <= limit) {
            return { value: count++, done: false };
          } else {
            return { value: undefined, done: true };
          }
        },
        // å¿…é¡»æœ‰è¿”å›å€¼
        return() {
          return { done: true };
        },
      };
    }
  }
  const arr = ["draven", "miya"];
  console.log("--ğŸš€-- ~ arr", arr);
  const iter1 = arr[Symbol.iterator]();
  console.log("--ğŸš€-- ~ iter1", iter1);
  const iter2 = iter1[Symbol.iterator]();
  // æ¯ä¸ªè¿­ä»£å™¨å†…éƒ¨ä¹Ÿå®ç°äº†Symbol[terator]
  console.log("--ğŸš€-- ~ iter2", iter2 === iter1);
  const count = new Counter1(3);
  for (const iterator of count) {
    console.log("--ğŸš€-- ~ iterator1", iterator);
  }
  for (const iterator of count) {
    console.log("--ğŸš€-- ~ iterator2", iterator);
  }
</script>
